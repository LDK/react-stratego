(this["webpackJsonpreact-stratego"]=this["webpackJsonpreact-stratego"]||[]).push([[0],{28:function(e,t,n){},29:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var i=n(0),c=n.n(i),o=n(21),a=n.n(o),r=(n(28),n(29),n(13)),s=n(2),l=n(10),d=n(7),u=n(20),j=n(1);function h(){var e=Object(l.c)(),t=e.authState,n=e.oktaAuth,c=Object(i.useState)(null),o=Object(u.a)(c,2),a=o[0],r=o[1],s=Object(i.useState)(!1),d=Object(u.a)(s,2),h=d[0],b=d[1];if(Object(i.useEffect)((function(){t&&t.isAuthenticated?n.token.getUserInfo().then((function(e){if(!a||!a.username){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userKey:e.sub,email:e.email})};fetch("http://localhost:3002/login",t).then((function(e){return e.json()})).then((function(t){r({email:t.email,id:t.user_id,key:e.sub,invite_available:t.invite_available,random_available:t.random_available,username:t.username}),b(!t.user_id)}))}})):r(null)}),[t,n]),!t)return Object(j.jsx)("div",{children:"Loading authentication..."});var O=function(){return n.signInWithRedirect({originalUri:"/"})},p=function(){return t.isAuthenticated?null:Object(j.jsx)("div",{children:Object(j.jsx)("button",{onClick:O,children:"Login"})})},g="";return g=t.isAuthenticated?h?Object(j.jsx)("div",{children:Object(j.jsx)("p",{children:"If you are seeing this, I should really open a modal to create your profile, new user."})}):a?Object(j.jsxs)("div",{children:[Object(j.jsxs)("p",{children:["Welcome, ",a.username,"!"]}),Object(j.jsx)("button",{onClick:function(){n.signOut()},children:"Logout"})]}):Object(j.jsx)("div",{children:Object(j.jsx)("p",{children:"Loading user info..."})}):Object(j.jsxs)("div",{children:[Object(j.jsx)("p",{children:"You need to sign in to use the application!"}),Object(j.jsx)(p,{})]}),Object(j.jsxs)("div",{className:"page-home",children:[Object(j.jsx)("h1",{children:"Welcome to Stratego"}),g]})}var b="dev-6379228.okta.com",O={clientId:"".concat("0oa2t6lqn7Qsg1T3g5d7"),issuer:"https://".concat(b,"/oauth2/default"),discoveryUri:"https://".concat(b,"/oauth2/default"),redirectUri:"http://localhost:3000/login-callback",endSessionRedirectUri:"http://localhost:3000/logout",scopes:["openid","profile","email"],requireHardwareBackedKeyStore:!1,pkce:!0},p=new d.OktaAuth(O),g=Object(d.toRelativeUrl)(window.location.href,window.location.origin);p.setOriginalUri(g);var f=function(){return Object(j.jsx)("div",{className:"App",children:Object(j.jsxs)(r.a,{children:[Object(j.jsxs)("header",{children:[Object(j.jsx)("div",{children:"Stratego"}),Object(j.jsx)("ul",{className:"menu",children:Object(j.jsx)("li",{children:Object(j.jsx)(r.b,{to:"/",children:"Home"})})})]}),Object(j.jsxs)(l.b,{oktaAuth:p,restoreOriginalUri:function(){window.location="/"},children:[Object(j.jsx)(s.a,{exact:!0,path:"/",component:h}),Object(j.jsx)(s.a,{path:"/login-callback",component:l.a})]})]})})},x=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,48)).then((function(t){var n=t.getCLS,i=t.getFID,c=t.getFCP,o=t.getLCP,a=t.getTTFB;n(e),i(e),c(e),o(e),a(e)}))};a.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(f,{})}),document.getElementById("root")),x()}},[[47,1,2]]]);
//# sourceMappingURL=main.d8752cf9.chunk.js.map