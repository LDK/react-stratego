(this["webpackJsonpreact-stratego"]=this["webpackJsonpreact-stratego"]||[]).push([[0],{28:function(e,t,n){},29:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var i=n(0),c=n.n(i),r=n(21),a=n.n(r),s=(n(28),n(7)),o=(n(29),n(12)),u=n(2),l=n(9),d=n(8),j=n(1);function h(e){var t=Object(l.c)(),n=t.authState,c=t.oktaAuth,r=e.app,a=r.userInfo,s=r.setUserInfo,o=r.unregistered,u=r.setUnregistered,d=r.checkAuth;if(Object(i.useEffect)((function(){return d({authState:n,oktaAuth:c,userInfo:a,setUserInfo:s,setUnregistered:u})}),[n,c]),!n)return Object(j.jsx)("div",{children:"Loading authentication..."});var h=function(){return c.signInWithRedirect({originalUri:"/"})},b=function(){return n.isAuthenticated?null:Object(j.jsx)("div",{children:Object(j.jsx)("button",{onClick:h,children:"Login"})})},O="",f="",p="",g=function(e,t,n){return Object(j.jsxs)("div",{id:t,children:[Object(j.jsx)("h3",{children:n}),Object(j.jsx)("ul",{children:e.map((function(e){return Object(j.jsx)("li",{children:Object(j.jsx)("a",{href:"/game/"+e.id,children:e.title})},"game-".concat(t,"-").concat(e.id))}))})]})};return n.isAuthenticated?o?O=Object(j.jsx)("div",{children:Object(j.jsx)("p",{children:"If you are seeing this, I should really open a modal to create your profile, new user."})}):a?(O=Object(j.jsxs)("div",{children:[Object(j.jsxs)("p",{children:["Welcome, ",a.username,"!"]}),Object(j.jsx)("button",{onClick:function(){c.signOut()},children:"Logout"})]}),a.recent_games&&(f=g(a.recent_games,"recent-games","Recent Games")),a.active_games&&(p=g(a.active_games,"active-games","Active Games"))):O=Object(j.jsx)("div",{children:Object(j.jsx)("p",{children:"Loading user info..."})}):O=Object(j.jsxs)("div",{children:[Object(j.jsx)("p",{children:"You need to sign in to use the application!"}),Object(j.jsx)(b,{})]}),Object(j.jsxs)("div",{className:"page-home",children:[Object(j.jsx)("h1",{children:"Welcome to Stratego"}),O,p,f]})}function b(e){var t=Object(u.e)().game_id,n=Object(l.c)(),c=n.authState,r=n.oktaAuth,a=e.app,o=a.userInfo,d=a.setUserInfo,h=a.unregistered,b=a.setUnregistered,O=a.checkAuth,f=Object(i.useState)(!1),p=Object(s.a)(f,2),g=p[0],m=p[1],x=Object(i.useState)(null),v=Object(s.a)(x,2),S=v[0],k=v[1],I=Object(i.useState)(null),_=Object(s.a)(I,2),U=_[0],y=_[1],A=Object(i.useState)(null),w=Object(s.a)(A,2),L=w[0],C=w[1],T=Object(i.useState)(null),N=Object(s.a)(T,2),G=N[0],Y=N[1],F=Object(i.useState)(null),J=Object(s.a)(F,2),P=J[0],R=J[1];if(Object(i.useEffect)((function(){return O({authState:c,oktaAuth:r,userInfo:o,setUserInfo:d,setUnregistered:b})}),[c,r]),!c)return Object(j.jsx)("div",{children:"Loading authentication..."});if(c.isAuthenticated){if(h)return Object(j.jsx)("div",{children:Object(j.jsx)("p",{children:"If you are seeing this, I should really open a modal to create your profile, new user."})});if(o){g||function(e,t){if(!g){var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,userKey:t.key,user_id:t.id})};fetch("http://localhost:3002/game",n).then((function(e){return e.json()})).then((function(e){m(!0),k(e.turn),y(e.starter_uid==t.id?"blue":"red"),C(e.starter_uid==t.id?e.opponent_name:e.starter_name),R(e.starter_name),Y(e.opponent_name)}))}}(t,o);var B="";return S&&(B=Object(j.jsxs)("p",{children:["red"==S?G:P,"'s turn."]})),Object(j.jsxs)("div",{className:"game-wrapper",children:["Game: ",t,". You are ",o.username,". You use ",U," tiles. Your opponent is ",L,".",B]})}return Object(j.jsx)("div",{children:Object(j.jsx)("p",{children:"Loading..."})})}return Object(j.jsx)("div",{children:Object(j.jsx)("p",{children:"You need to sign in to use the application!"})})}var O="dev-6379228.okta.com",f={clientId:"".concat("0oa2t6lqn7Qsg1T3g5d7"),issuer:"https://".concat(O,"/oauth2/default"),discoveryUri:"https://".concat(O,"/oauth2/default"),redirectUri:"http://localhost:3000/login-callback",endSessionRedirectUri:"http://localhost:3000/logout",scopes:["openid","profile","email"],requireHardwareBackedKeyStore:!1,pkce:!0},p=new d.OktaAuth(f),g=Object(d.toRelativeUrl)(window.location.href,window.location.origin);p.setOriginalUri(g);var m=function(){var e=Object(i.useState)(null),t=Object(s.a)(e,2),n=t[0],c=t[1],r=Object(i.useState)(!1),a=Object(s.a)(r,2),d={userInfo:n,setUserInfo:c,unregistered:a[0],setUnregistered:a[1],checkAuth:function(e){var t=e.authState,n=e.oktaAuth,i=e.userInfo,c=e.setUserInfo,r=e.setUnregistered;t&&t.isAuthenticated?i&&i.username||n.token.getUserInfo().then((function(e){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userKey:e.sub,email:e.email})};fetch("http://localhost:3002/login",t).then((function(e){return e.json()})).then((function(t){c({email:t.email,id:t.user_id,key:e.sub,invite_available:t.invite_available,random_available:t.random_available,username:t.username,recent_games:t.recentGames,active_games:t.activeGames}),r(!t.user_id)}))})):c(null)}};return Object(j.jsx)("div",{className:"App",children:Object(j.jsxs)(o.a,{children:[Object(j.jsxs)("header",{children:[Object(j.jsx)("div",{children:"Stratego"}),Object(j.jsx)("ul",{className:"menu",children:Object(j.jsx)("li",{children:Object(j.jsx)(o.b,{to:"/",children:"Home"})})})]}),Object(j.jsxs)(l.b,{oktaAuth:p,restoreOriginalUri:function(){window.location="/"},children:[Object(j.jsx)(u.a,{exact:!0,path:"/",children:Object(j.jsx)(h,{app:d})}),Object(j.jsx)(u.a,{path:"/game/:game_id",children:Object(j.jsx)(b,{app:d})}),Object(j.jsx)(u.a,{path:"/login-callback",component:l.a})]})]})})},x=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,48)).then((function(t){var n=t.getCLS,i=t.getFID,c=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),i(e),c(e),r(e),a(e)}))};a.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(m,{})}),document.getElementById("root")),x()}},[[47,1,2]]]);
//# sourceMappingURL=main.65217e18.chunk.js.map