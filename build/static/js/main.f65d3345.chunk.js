(this["webpackJsonpreact-stratego"]=this["webpackJsonpreact-stratego"]||[]).push([[0],{51:function(e,t,a){},52:function(e,t,a){},70:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(41),i=a.n(r),s=(a(51),a(4)),o=(a(52),a(53),a(23)),l=a(3),u=a(13),d=a(12),j=a(1);function h(e){var t=Object(u.c)(),a=t.authState,c=t.oktaAuth,r=e.app,i=r.userInfo,s=r.setUserInfo,o=r.unregistered,l=r.setUnregistered,d=r.checkAuth;if(Object(n.useEffect)((function(){return d({authState:a,oktaAuth:c,userInfo:i,setUserInfo:s,setUnregistered:l})}),[a,c]),!a)return Object(j.jsx)("div",{children:"Loading authentication..."});var h=function(){return c.signInWithRedirect({originalUri:"/"})},b=function(){return a.isAuthenticated?null:Object(j.jsx)("div",{children:Object(j.jsx)("button",{onClick:h,children:"Login"})})},O="",p="",f="",g=function(e,t,a){return Object(j.jsxs)("div",{id:t,children:[Object(j.jsx)("h3",{children:a}),Object(j.jsx)("ul",{children:e.map((function(e){return Object(j.jsx)("li",{children:Object(j.jsx)("a",{href:"/game/"+e.id,children:e.title})},"game-".concat(t,"-").concat(e.id))}))})]})};return a.isAuthenticated?o?O=Object(j.jsx)("div",{children:Object(j.jsx)("p",{children:"If you are seeing this, I should really open a modal to create your profile, new user."})}):i?(O=Object(j.jsxs)("div",{children:[Object(j.jsxs)("p",{children:["Welcome, ",i.username,"!"]}),Object(j.jsx)("button",{onClick:function(){c.signOut()},children:"Logout"})]}),i.recent_games&&(p=g(i.recent_games,"recent-games","Recent Games")),i.active_games&&(f=g(i.active_games,"active-games","Active Games"))):O=Object(j.jsx)("div",{children:Object(j.jsx)("p",{children:"Loading user info..."})}):O=Object(j.jsxs)("div",{children:[Object(j.jsx)("p",{children:"You need to sign in to use the application!"}),Object(j.jsx)(b,{})]}),Object(j.jsxs)("div",{className:"page-home",children:[Object(j.jsx)("h1",{children:"Welcome to Stratego"}),O,f,p]})}var b=a(22),O=a(14),p=a(19),f=a(77),g=a(76),m=function(e){var t=e.rank,a=e.color,n=e.squareId,c=e.playerColor,r=e.turn,i=Object(g.a)({type:"GamePiece",canDrag:c==a||c==r,item:{rank:t,color:a,squareId:n},collect:function(e){return{isDragging:e.isDragging()}}}),o=Object(s.a)(i,2),l=o[0].isDragging,u=o[1];return Object(j.jsxs)("div",{className:"game-piece",ref:u,"data-rank":t,"data-color":a,"data-square":n,children:[a||""," ",t&&a?t||"?":"",l&&"\ud83d\ude31"]})},x=[43,44,47,48,53,54,57,58],v=function(e){var t,a,n=e.x,c=e.y,r=e.id,i=(e.data,e.playerColor),o=e.turn,l=Object(f.a)({accept:"GamePiece",drop:function(e){!function(e){console.log("dropped this",e)}(e)},collect:function(e){return{isOver:e.isOver()}}}),u=Object(s.a)(l,2),d=(u[0].isOver,u[1]);return x.includes(r)?Object(j.jsx)(O.a,{className:"game-space unpassable text-center","data-x":n,"data-y":c,"data-id":r,"data-passable":!1,children:"X"}):(e.data&&(t=e.data.rank,a=e.data.color),Object(j.jsx)(O.a,{className:"game-space","data-x":n,"data-y":c,"data-id":r,ref:d,children:Object(j.jsx)(m,{rank:t,turn:o,color:a,squareId:r,playerColor:i})}))},k=function(e){for(var t=e.y,a=e.spaces,n=e.playerColor,c=e.turn,r=1,i=[];r<=10;){var s=10*(t-1)+r;i.push(Object(j.jsx)(v,{turn:c,playerColor:n,y:t,x:r,id:s,data:a[s]},s)),r++}return Object(j.jsx)(b.a,{className:"board-row",children:i})},y=function(e){if(!e||!e.data)return null;var t=[],a={};e.data.spaces&&(a=JSON.parse(e.data.spaces));for(var n=1;n<=10;)t.push(Object(j.jsx)(k,{turn:e.turn,playerColor:e.color,spaces:a,y:n},"row-"+n)),n++;return Object(j.jsxs)(p.a,{className:"game-board",children:[Object(j.jsxs)("p",{children:["game board, last checked ",e.lastChecked]}),t]})},S=function(e){return Object(j.jsxs)(p.a,{className:"tile-rack",children:["TILE RACK",Object(j.jsx)(m,{rank:"3",color:"Blue"})]})},I=a(75),w=a(45);function _(e){var t=Object(l.e)().game_id,a=Object(u.c)(),c=a.authState,r=a.oktaAuth,i=e.app,o=i.userInfo,d=i.setUserInfo,h=i.unregistered,f=i.setUnregistered,g=i.checkAuth,m=Object(n.useState)(!1),x=Object(s.a)(m,2),v=x[0],k=x[1],_=Object(n.useState)(!1),U=Object(s.a)(_,2),A=U[0],C=U[1],N=Object(n.useState)(null),L=Object(s.a)(N,2),T=L[0],D=L[1],G=Object(n.useState)(null),q=Object(s.a)(G,2),P=q[0],J=q[1],R=Object(n.useState)(null),Y=Object(s.a)(R,2),B=Y[0],E=Y[1],F=Object(n.useState)(null),K=Object(s.a)(F,2),W=K[0],H=K[1],M=Object(n.useState)(null),Q=Object(s.a)(M,2),X=Q[0],z=Q[1],V=Object(n.useState)(Date.now()),Z=Object(s.a)(V,2),$=Z[0],ee=Z[1],te=Object(n.useState)(null),ae=Object(s.a)(te,2),ne=ae[0],ce=ae[1],re=Object(n.useState)(!1),ie=Object(s.a)(re,2),se=ie[0],oe=ie[1];if(Object(n.useEffect)((function(){return g({authState:c,oktaAuth:r,userInfo:o,setUserInfo:d,setUnregistered:f})}),[c,r]),!c)return Object(j.jsx)("div",{children:"Loading authentication..."});if(se)return Object(j.jsx)("div",{children:"Sorry, no game was found with that id."});if(c.isAuthenticated){if(h)return Object(j.jsx)("div",{children:Object(j.jsx)("p",{children:"If you are seeing this, I should really open a modal to create your profile, new user."})});if(o){v||A||function(e,t){if(!v){C(!0);var a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,userKey:t.key,user_id:t.id})};fetch("http://localhost:3002/game",a).then((function(e){e.ok?e.json().then((function(e){k(!0),C(!1),D(e.turn),J(e.starter_uid==t.id?"blue":"red"),E(e.starter_uid==t.id?e.opponent_name:e.starter_name),z(e.starter_name),H(e.opponent_name),ee(Date.now()),ce(e)})):oe(!0)}))}}(t,o);var le="";return T&&(le=Object(j.jsxs)("p",{children:["red"==T?W:X,"'s turn."]})),Object(j.jsxs)(p.a,{fluid:!0,className:"game-wrapper",children:["Game: ",t,". You are ",o.username,". Your opponent is ",B,". You use ",P," tiles.",le,Object(j.jsx)(I.a,{backend:w.a,children:Object(j.jsxs)(b.a,{children:[Object(j.jsx)(O.a,{xs:12,md:8,lg:9,children:Object(j.jsx)(y,{data:ne,lastChecked:$,color:P,turn:T})}),Object(j.jsx)(O.a,{xs:12,md:4,lg:3,children:Object(j.jsx)(S,{})})]})})]})}return Object(j.jsx)("div",{children:Object(j.jsx)("p",{children:"Loading..."})})}return window.location="/",Object(j.jsx)("div",{children:Object(j.jsx)("p",{children:"You need to sign in to use the application!"})})}var U="dev-6379228.okta.com",A={clientId:"".concat("0oa2t6lqn7Qsg1T3g5d7"),issuer:"https://".concat(U,"/oauth2/default"),discoveryUri:"https://".concat(U,"/oauth2/default"),redirectUri:"http://localhost:3000/login-callback",endSessionRedirectUri:"http://localhost:3000/logout",scopes:["openid","profile","email"],requireHardwareBackedKeyStore:!1,pkce:!0},C=new d.OktaAuth(A),N=Object(d.toRelativeUrl)(window.location.href,window.location.origin);C.setOriginalUri(N);var L=function(){return Object(j.jsxs)("header",{children:[Object(j.jsx)("div",{children:"Stratego"}),Object(j.jsx)("ul",{className:"menu",children:Object(j.jsx)("li",{children:Object(j.jsx)(o.b,{to:"/",children:"Home"})})})]})},T=function(){var e=Object(n.useState)(null),t=Object(s.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(!1),i=Object(s.a)(r,2),d={userInfo:a,setUserInfo:c,unregistered:i[0],setUnregistered:i[1],checkAuth:function(e){var t=e.authState,a=e.oktaAuth,n=e.userInfo,c=e.setUserInfo,r=e.setUnregistered;t&&t.isAuthenticated?n&&n.username||a.token.getUserInfo().then((function(e){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userKey:e.sub,email:e.email})};fetch("http://localhost:3002/login",t).then((function(e){return e.json()})).then((function(t){c({email:t.email,id:t.user_id,key:e.sub,invite_available:t.invite_available,random_available:t.random_available,username:t.username,recent_games:t.recentGames,active_games:t.activeGames}),r(!t.user_id)}))})):c(null)}};return Object(j.jsx)("div",{className:"App",children:Object(j.jsxs)(o.a,{children:[Object(j.jsx)(L,{}),Object(j.jsxs)(u.b,{oktaAuth:C,restoreOriginalUri:function(){window.location="/"},children:[Object(j.jsx)(l.a,{exact:!0,path:"/",children:Object(j.jsx)(h,{app:d})}),Object(j.jsx)(l.a,{path:"/game/:game_id",children:Object(j.jsx)(_,{app:d})}),Object(j.jsx)(l.a,{path:"/login-callback",component:u.a})]})]})})},D=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,78)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;a(e),n(e),c(e),r(e),i(e)}))};i.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(T,{})}),document.getElementById("root")),D()}},[[70,1,2]]]);
//# sourceMappingURL=main.f65d3345.chunk.js.map